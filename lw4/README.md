# Задание #4 Развитие Publish/Subscribe. Шаблоны Post/Redirect/Get, Retry

## Постановка задачи

Заказчик хочет предоставить пользователям новый функционал: давать оценку вводимых текстов по некоторому критерию. 
Критерием оценки на начальном этапе является отношение количества гласных букв к количеству согласных, 
но в будущем этот функционал будет развиваться и планируется задействовать более сложные алгоритмы оценок.

## Реализация.

Задание является развитием Задания #3

Frontend по прежнему отправляет вводимый текст в *Backend* через вызов веб-службы. 
Компонент *Backend* генерирует идентификатор контекста обработки, помещает текст в хранилище, создаёт сообщение 
*TextCreated* с идентификатором контекста обработки и помещает его в очередь *backend-api*.
После чего возвращает значение идентификатора в ответе на запрос.

### Frontend

*Frontend* компонент, отправив текст в *Backend* через вызов веб-службы, перенаправляет пользователя на страницу 
просмотра оценки текста *TextDetails*, где ему покажется результат оценивания текста. 
В параметрах адреса *TextDetails* должно передаваться значение идентификатора контекста обработки.
При загрузке страницы *TextDetails* на серверной части происходит обращение к REST-сервису компонента *Backend* 
для получения значения оценки. Возможные коды ошибок должны соответстующим образом обрабатываться, например 
выводится текст о неполадках.
Данная модель поведения веб-приложения относится к шаблону **Post/Redirect/Get**.

### Backend Web-Api

Добавляется метод веб-службы, принимающий в качестве параметра идентификатор контекста обработки и возвращающий 
оценку текста, полученную в результате вычислений.

Порядок обработки запроса в методе:

1. По идентификатору из хранилища извлекается результат оценивания текста.
2. Если соответствующих данных в хранилище не найдено, производится несколько попыток получения данных 
с коротким «засыпанием» между попытками.
3. При достижении максимального количества попыток или успешном получении результата в ответе за запрос 
возвращается значение оценки или код ошибки *404 Not Found*.

Модель поведения приложения, когда происходит несколько попыток доступа к ресурсу, называется **Retry**.

#### Оценка текста: TextRankCalc
Появляется новый компонент **TextRankCalc**. Компонент представляет собой консольное приложение. 
При запуске компонент начинает слушать сообщения *TextCreated* в очереди *backend-api*.
Действия при получении сообщения *TextCreated*:
1.	По идентификатору в сообщении извлекает из Redis-хранилища соответствующий текст.
2.	Подсчитывает количество гласных и согласных букв в тексте.
3.	Подсчитывает оценку текста в виде отношения количества гласных к количеству согласных букв.
4.	В Redis- хранилище записывается полученная оценка по идентификатору контекста.